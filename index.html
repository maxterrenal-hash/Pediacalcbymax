<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pediatric Calculator</title>
<style>
  :root{
    /* iOS Quartz Frost (cool, airy) */
    --bg:#F5F7FB;           /* background */
    --fg:#0F172A;           /* primary text */
    --muted:#475569;        /* secondary text */
    --accent:#3B82F6;       /* link/icon accent */
    --line:#E2E8F0;         /* separators */
    --groupA:#FFFFFF;       /* light cell */
    --groupB:#F2F6FF;       /* soft blue cell */
    --hdr:#EEF2F7;          /* header tint */
    --card:#FFFFFF;         /* card base */
    --card2:#F6FAFF;        /* card alt */
  }
  *{box-sizing:border-box}
  body{background:var(--bg);color:var(--fg);font-family:-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif;max-width:1100px;margin:0 auto;padding:20px}
  h1{color:var(--fg);margin:0 0 12px;font-weight:700;letter-spacing:.2px}
  details summary{cursor:pointer;font-size:17px;color:var(--fg);margin:14px 0 6px;font-weight:600;padding:10px 12px;background:#FFFFFF;border:1px solid var(--line);border-radius:12px}

  table{overflow:visible;width:100%;border-collapse:separate;border-spacing:0;margin-top:8px;font-size:14px;position:relative;background:#FFFFFF;border:1px solid var(--line);border-radius:14px}
  th{position:sticky;top:0;z-index:2;background:var(--hdr);color:var(--muted);border-bottom:1px solid var(--line);padding:10px 8px;text-align:center;font-weight:600}
  td{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;border-top:1px solid var(--line);padding:10px 8px;text-align:center;color:var(--fg)}
  td.computed{background:transparent!important;color:inherit!important;font-weight:700;font-size:16px;animation:popIn 0.25s ease-out;border-radius:0;box-shadow:none}
  .calc.computed{background:transparent!important;color:inherit!important;font-weight:700;font-size:16px;border-radius:0;padding:0;display:inline;line-height:inherit}

  @keyframes popIn{0%{transform:translateY(4px);opacity:0}100%{transform:translateY(0);opacity:1}}

  
  .groupStart td{padding-top:12px;background:var(--card)!important;border-radius:14px 14px 0 0!important}
  .groupEnd td{padding-bottom:12px;border-radius:0 0 14px 14px!important}
  #resultTable td:empty{border-top-color:transparent!important;border-bottom-color:transparent!important}

  /* Force no right rounding on first column */
  #resultTable td:first-child:not(:empty){color:var(--fg)!important;font-weight:700!important}

  /* ===== Resus grouping look-alike to antibiotics ===== */
  #resusTable tbody tr.resusA td{background:var(--groupA)!important}
  #resusTable tbody tr.resusB td{background:var(--groupB)!important}

  /* Tooltips */
  .note-tip{cursor:pointer;position:relative;color:var(--fg);font-weight:700}
  .note-tip::after{content:attr(data-note);position:absolute;left:50%;top:0;transform:translate(-50%,-110%);background:white;border:1px solid var(--line);padding:6px 10px;border-radius:6px;white-space:normal;display:none;width:260px;z-index:9999;box-shadow:0 2px 6px rgba(0,0,0,0.15)}
  .note-tip.touch-active::after{display:block}

  /* Tooltip overflow and hover */
  td:has(.note-tip), th:has(.note-tip){ overflow:visible !important }
  .note-tip{ display:inline-block }
  @media (hover:hover){ .note-tip:hover::after{ display:block } }

  /* Tooltip overflow and hover */
  td:has(.note-tip), th:has(.note-tip){ overflow:visible !important }
  .note-tip{ display:inline-block }
  @media (hover:hover){ .note-tip:hover::after{ display:block } }

  /* Tooltip overflow and hover */
  td:has(.note-tip), th:has(.note-tip){ overflow:visible !important }
  .note-tip{ display:inline-block }
  @media (hover:hover){ .note-tip:hover::after{ display:block } }

  /* Tooltip overflow and hover */
  td:has(.note-tip), th:has(.note-tip){ overflow:visible !important }
  .note-tip{ display:inline-block }
  @media (hover:hover){ .note-tip:hover::after{ display:block } }

  /* Tooltip overflow and hover */
  td:has(.note-tip), th:has(.note-tip){ overflow:visible !important }
  .note-tip{ display:inline-block }
  @media (hover:hover){ .note-tip:hover::after{ display:block } }

  /* Tooltip overflow and hover */
  td:has(.note-tip), th:has(.note-tip){ overflow:visible !important }
  .note-tip{ display:inline-block }
  @media (hover:hover){ .note-tip:hover::after{ display:block } }

  /* Anaphylaxis adjunct rounded columns */
  #anaAdjTable th, #anaAdjTable td{position:relative}
  #anaAdjTable th:nth-child(2), #anaAdjTable td:nth-child(2),
  #anaAdjTable th:nth-child(3), #anaAdjTable td:nth-child(3),
  #anaAdjTable th:nth-child(4), #anaAdjTable td:nth-child(4){
    background:var(--card);border-left:1px solid var(--line);border-right:1px solid var(--line)
  }
  #anaAdjTable thead tr th{border-top-left-radius:12px;border-top-right-radius:12px}
  #anaAdjTable tbody tr:last-child td{border-bottom-left-radius:12px;border-bottom-right-radius:12px}
  #anaAdjTable{border-collapse:separate;border-spacing:0}

  /* Diagnostics */
  #diag{margin-top:16px;font-size:13px;color:#333}
  #diag pre{background:#f7f7fb;border:1px solid #e6e6ef;padding:8px;border-radius:8px;white-space:pre-wrap}

  /* Weight input prominence */
  label{font-size:20px;font-weight:700;display:inline-flex;align-items:center;gap:12px;margin:10px 0 14px}
  #weightInput{font-size:20px;line-height:1;padding:10px 14px;height:48px;min-width:200px;border:1.5px solid var(--line);border-radius:12px;background:#fff;color:var(--fg)}
  @media (max-width:600px){label{font-size:18px}#weightInput{font-size:18px;height:46px;min-width:160px}}

  /* Paracetamol quick meds */
  #fastMedsTable, #amoxQuick, #ampSulbQuick, #azithQuick, #cefixQuick, #ceftriaQuick, #cefurQuick, #cephalQuick, #clarithQuick, #clindaQuick, #coamoxQuick, #metroQuick{border-radius:0!important;box-shadow:none!important}
  #amoxQuick th, #ampSulbQuick th, #azithQuick th, #cefixQuick th, #ceftriaQuick th, #cefurQuick th, #cephalQuick th, #clarithQuick th, #clindaQuick th, #coamoxQuick th, #metroQuick th{background:var(--hdr);color:var(--muted);font-weight:600;padding:10px 8px;text-align:center;border-bottom:1px solid var(--line)}
  #amoxQuick td, #ampSulbQuick td, #azithQuick td, #cefixQuick td, #ceftriaQuick td, #cefurQuick td, #cephalQuick td, #clarithQuick td, #clindaQuick td, #coamoxQuick td, #metroQuick td{padding:10px 8px;text-align:center;border-top:1px solid var(--line)}

  /* Mobile: keep tables 100% width and avoid horizontal scroll */
  @media (max-width:680px){
    #fluidTable, #resultTable, #resusTable, #seTable, #seInfusions, #anaEpiTable, #anaAdjTable,
    #amoxQuick, #ampSulbQuick, #azithQuick, #cefixQuick, #ceftriaQuick, #cefurQuick, #cephalQuick, #clarithQuick, #clindaQuick, #coamoxQuick, #metroQuick{width:100%!important;table-layout:fixed!important}

    /* Loosen tight dose columns (q6–q24) */
    #resultTable th:first-child, #resultTable td:first-child{width:22%!important}
    #resultTable th:nth-child(2), #resultTable td:nth-child(2){width:20%!important}
    #resultTable th:nth-child(n+3):nth-child(-n+6),
    #resultTable td:nth-child(n+3):nth-child(-n+6){width:14.5%!important;min-width:11ch!important}

    /* SE groups */
    #seTable th:first-child, #seTable td:first-child{width:32%!important}
    #seTable th:nth-child(2), #seTable td:nth-child(2){width:34%!important;min-width:10ch!important}
    #seTable th:nth-child(3), #seTable td:nth-child(3){width:34%!important;min-width:10ch!important}

    /* SE Infusions */
    #seInfusions th:first-child, #seInfusions td:first-child{width:26%!important}
    #seInfusions th:nth-child(2), #seInfusions td:nth-child(2),
    #seInfusions th:nth-child(3), #seInfusions td:nth-child(3),
    #seInfusions th:nth-child(4), #seInfusions td:nth-child(4){width:24.7%!important;min-width:10ch!important}
  }
  /* Normalize first-column width across all Antibiotic quick tables */
  #amoxQuick th:first-child, #ampSulbQuick th:first-child, #azithQuick th:first-child, #cefixQuick th:first-child, #ceftriaQuick th:first-child, #cefurQuick th:first-child, #cephalQuick th:first-child, #clarithQuick th:first-child, #clindaQuick th:first-child, #coamoxQuick th:first-child, #metroQuick th:first-child,
  #amoxQuick td:first-child, #ampSulbQuick td:first-child, #azithQuick td:first-child, #cefixQuick td:first-child, #ceftriaQuick td:first-child, #cefurQuick td:first-child, #cephalQuick td:first-child, #clarithQuick td:first-child, #clindaQuick td:first-child, #coamoxQuick td:first-child, #metroQuick td:first-child{
    width:220px; /* desktop/tablet */
    max-width:220px;
    min-width:220px;
    text-align:left;
  }

  /* Keep header titles readable if they wrap */
  #amoxQuick th:first-child, #ampSulbQuick th:first-child, #azithQuick th:first-child, #cefixQuick th:first-child, #ceftriaQuick th:first-child, #cefurQuick th:first-child, #cephalQuick th:first-child, #clarithQuick th:first-child, #clindaQuick th:first-child, #coamoxQuick th:first-child, #metroQuick th:first-child{
    white-space:normal;
  }

  $1

  /* Normalize first-column width across Resuscitation and Status Epilepticus tables */
  #resusTable th:first-child, #resusTable td:first-child,
  #seTable th:first-child, #seTable td:first-child,
  #seInfusions th:first-child, #seInfusions td:first-child{
    width:220px; /* desktop/tablet */
    max-width:220px;
    min-width:220px;
    text-align:left;
  }
  @media (max-width:680px){
    #resusTable th:first-child, #resusTable td:first-child,
    #seTable th:first-child, #seTable td:first-child,
    #seInfusions th:first-child, #seInfusions td:first-child{
      width:180px;
      max-width:180px;
      min-width:180px;
    }
  }
</style>
</head>
<body>

<h1>Pediatric Calculator</h1>

<label>Weight (kg): <input type="number" id="weightInput" min="0" step="0.1"></label>
<div id="warning" style="color:#ff6b6b;font-weight:700;margin-top:6px"></div>

<details>
  <summary>IV Fluids</summary>
  <table id="fluidTable">
    <thead>
      <tr><th>Maintenance</th><th>Mild (8h)</th><th>Moderate (6h)</th><th>Severe (6h + 6h)</th><th>Bolus (20 mL/kg)</th></tr>
    </thead>
    <tbody>
      <tr>
        <td id="maintOut"></td><td id="mildOut"></td><td id="modOut"></td><td id="sevOut"></td><td id="bolusOut"></td>
      </tr>
    </tbody>
  </table>

  <!-- Quick Antipyretic/Analgesic Doses (mL) -->
  <table id="fastMedsTable">
    <thead>
      <tr>
        <th>Paracetamol 100mg/mL</th>
        <th>Paracetamol 125mg/5mL</th>
        <th>Paracetamol 250mg/mL</th>
        <th>Ibuprofen 200mg/5mL</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td id="para100"></td>
        <td id="para125"></td>
        <td id="para250"></td>
        <td id="ibu200"></td>
      </tr>
    </tbody>
  </table></details>

<details>
  <summary>Antibiotic Dose Table</summary>
  

  <!-- Amoxicillin quick reference (mL per dose) -->
  <table id="amoxQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Amoxicillin</th>
        <th>q8h</th>
        <th>q12h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>100mg/mL</td>
        <td id="amox100q8"></td>
        <td id="amox100q12"></td>
      </tr>
      <tr>
        <td>125mg/5mL</td>
        <td id="amox125q8"></td>
        <td id="amox125q12"></td>
      </tr>
      <tr>
        <td>250mg/5mL</td>
        <td id="amox250q8"></td>
        <td id="amox250q12"></td>
      </tr>
    </tbody>
  </table>

  <!-- Ampicillin-Sulbactam quick reference (per-dose mg) -->
  <table id="ampSulbQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Ampicillin–Sulbactam <span class="note-tip" data-note="200 mg/kg/day IV q6h">ⓘ</span></th>
        <th>q6h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>IV</td>
        <td id="ampSulbIVq6"></td>
      </tr>
    </tbody>
  </table>

  <!-- Azithromycin quick reference (mL per dose) -->
  <table id="azithQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Azithromycin <span class="note-tip" data-note="10 mg/kg q24h">ⓘ</span></th>
        <th>q24h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>200mg/5mL</td>
        <td id="azith200q24"></td>
      </tr>
    </tbody>
  </table>

  <!-- Cefixime quick reference (mL per dose) -->
  <table id="cefixQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Cefixime <span class="note-tip" data-note="8 mg/kg q12h or q24h">ⓘ</span></th>
        <th>q12h</th>
        <th>q24h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>100mg/5mL</td>
        <td id="cefix100q12"></td>
        <td id="cefix100q24"></td>
      </tr>
      <tr>
        <td>20mg/5mL</td>
        <td id="cefix20_5q12"></td>
        <td id="cefix20_5q24"></td>
      </tr>
    </tbody>
  </table>

  <!-- Ceftriaxone quick reference (per-dose mg) -->
  <table id="ceftriaQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Ceftriaxone <span class="note-tip" data-note="75 to 100 mg/kg IV q12h or q24h">ⓘ</span></th>
        <th>q12h</th>
        <th>q24h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>IV</td>
        <td id="ceftriaIVq12"></td>
        <td id="ceftriaIVq24"></td>
      </tr>
    </tbody>
  </table>

  <!-- Cefuroxime quick reference (mL for PO, mg for IV) -->
  <table id="cefurQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Cefuroxime <span class="note-tip" data-note="20–30 mg/kg PO q12h or IV 100–150 mg/kg/day q8h">ⓘ</span></th>
        <th>q8h</th>
        <th>q12h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>125mg/5mL</td>
        <td>-</td>
        <td id="cefur125q12"></td>
      </tr>
      <tr>
        <td>250mg/5mL</td>
        <td>-</td>
        <td id="cefur250q12"></td>
      </tr>
      <tr>
        <td>IV</td>
        <td id="cefurIVq8"></td>
        <td>-</td>
      </tr>
    </tbody>
  </table>

  <!-- Cephalexin quick reference (mL per q12h dose) -->
  <table id="cephalQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Cephalexin <span class="note-tip" data-note="25–50 mg/kg q12h">ⓘ</span></th>
        <th>q12h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>100mg/mL</td>
        <td id="cephal100q12"></td>
      </tr>
      <tr>
        <td>125mg/5mL</td>
        <td id="cephal125q12"></td>
      </tr>
      <tr>
        <td>250mg/5mL</td>
        <td id="cephal250q12"></td>
      </tr>
    </tbody>
  </table>

  <!-- Clarithromycin quick reference (mL per q12h dose) -->
  <table id="clarithQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Clarithromycin <span class="note-tip" data-note="15 mg/kg q12h">ⓘ</span></th>
        <th>q12h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>125mg/5mL</td>
        <td id="clarith125q12"></td>
      </tr>
    </tbody>
  </table>

  <!-- Clindamycin quick reference (mL per q8h dose) -->
  <table id="clindaQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Clindamycin <span class="note-tip" data-note="20–30 mg/kg q8h">ⓘ</span></th>
        <th>q8h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>75mg/5mL</td>
        <td id="clinda75q8"></td>
      </tr>
    </tbody>
  </table>

  <!-- Co-amoxiclav quick reference (mL per dose) -->
  <table id="coamoxQuick" style="margin-top:12px;border-collapse:separate;border-spacing:0;background:#FFFFFF;border:1px solid var(--line);width:100%">
    <thead>
      <tr>
        <th>Co-amoxiclav <span class="note-tip" data-note="25–45 mg/kg q8h or q12h">ⓘ</span></th>
        <th>q8h</th>
        <th>q12h</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>156.25mg/5mL</td>
        <td id="coamox156q8"></td>
        <td id="coamox156q12"></td>
      </tr>
      <tr>
        <td>228.5mg/5mL</td>
        <td id="coamox228q8"></td>
        <td id="coamox228q12"></td>
      </tr>
      <tr>
        <td>312.5mg/5mL</td>
        <td id="coamox312q8"></td>
        <td id="coamox312q12"></td>
      </tr>
      <tr>
        <td>457mg/5mL</td>
        <td id="coamox457q8"></td>
        <td id="coamox457q12"></td>
      </tr>
    </tbody>
  </table>
</details>

<details>
  <summary>Resuscitation</summary>
  <table id="resusTable">
    <thead><tr><th>Medication / Measure</th><th>Dose / Value</th></tr></thead>
    <tbody class="resus-notes-tooltip">
      <tr><td>ET Tube Size</td><td id="ettSize"></td></tr>
      <tr><td>ET Depth</td><td id="ettDepth"></td></tr>
      <tr><td>Laryngoscope Blade</td><td id="bladeSize"></td></tr>
      <tr><td>Epinephrine (IV/IO) <span class="note-tip" data-note="1:10,000 concentration. 0.01 mg/kg IV/IO q3–5 min. Max single dose 1 mg.">ⓘ</span></td><td id="epiIV"></td></tr>
      <tr><td>Epinephrine (ET) <span class="note-tip" data-note="0.1 mg/kg ET (1:1,000). Use if IV/IO not available.">ⓘ</span></td><td id="epiET"></td></tr>
      <tr><td>Atropine (IV/IO) <span class="note-tip" data-note="0.02 mg/kg IV/IO (min 0.1 mg). Max single dose child 0.5 mg, adolescent 1 mg. May repeat once.">ⓘ</span></td><td id="atroIV"></td></tr>
      <tr><td>Atropine (ET) <span class="note-tip" data-note="0.04–0.06 mg/kg ET.">ⓘ</span></td><td id="atroET"></td></tr>
      <tr><td>Adenosine (1st dose) <span class="note-tip" data-note="0.1 mg/kg rapid IV push (max 6 mg)">ⓘ</span></td><td id="adeno1"></td></tr>
      <tr><td>Adenosine (2nd dose) <span class="note-tip" data-note="0.2 mg/kg rapid IV push (max 12 mg)">ⓘ</span></td><td id="adeno2"></td></tr>
      <tr><td>Amiodarone (SVT/VT) <span class="note-tip" data-note="5 mg/kg IV/IO over 20–60 min. Max single dose 300 mg. Max daily 15 mg/kg.">ⓘ</span></td><td id="amioPulse"></td></tr>
      <tr><td>Amiodarone (Pulseless Arrest) <span class="note-tip" data-note="5 mg/kg IV/IO bolus. May repeat to max daily 15 mg/kg.">ⓘ</span></td><td id="amioArrest"></td></tr>
      <tr><td>Cardioversion (1st Shock) <span class="note-tip" data-note="Synchronized cardioversion: 0.5–1 J/kg initial">ⓘ</span></td><td id="cv1"></td></tr>
      <tr><td>Cardioversion (2nd Shock) <span class="note-tip" data-note="If ineffective, increase to 2 J/kg">ⓘ</span></td><td id="cv2"></td></tr>
      <tr><td>Defibrillation (2 J/kg) <span class="note-tip" data-note="Initial unsynchronized shock: 2 J/kg">ⓘ</span></td><td id="defib1"></td></tr>
      <tr><td>Defibrillation (4 J/kg) <span class="note-tip" data-note="Second shock: 4 J/kg; may increase up to 10 J/kg">ⓘ</span></td><td id="defib2"></td></tr>
    </tbody>
  </table>
</details>

<details>
  <summary>Status Epilepticus</summary>
  <!-- Group 1: Initial Treatment (Midazolam / Diazepam) -->
  <table id="seTable">
    <tbody>
      <tr class="se-subhdr se-g1">
        <th>Initial Treatment</th>
        <th>IV</th>
        <th>IN/IM or PR</th>
        <th class="se-collapsed"></th>
        <th class="se-collapsed"></th>
        <th class="se-collapsed"></th>
      </tr>
      <tr class="row-midazolam">
        <td>Midazolam</td>
        <td><span id="midIV" class="calc"></span> <span class="note-tip" data-note="0.1–0.2 mg/kg IV">ⓘ</span></td>
        <td><span id="midINIM" class="calc"></span> <span class="note-tip" data-note="0.2 mg/kg Intranasal or IM">ⓘ</span></td>
        <td class="se-collapsed"></td>
        <td class="se-collapsed"></td>
        <td class="se-collapsed"></td>
      </tr>
      <tr class="row-diazepam">
        <td>Diazepam</td>
        <td><span id="diazIV" class="calc"></span> <span class="note-tip" data-note="0.1–0.3 mg/kg IV">ⓘ</span></td>
        <td><span id="diazPR" class="calc"></span> <span class="note-tip" data-note="0.5 mg/kg PR">ⓘ</span></td>
        <td class="se-collapsed"></td>
        <td class="se-collapsed"></td>
        <td class="se-collapsed"></td>
      </tr>

      <!-- Group 2: 2nd & 3rd Line -->
      <tr class="se-subhdr se-g1b">
        <th>2nd and 3rd Line</th>
        <th>IV</th>
        <th>Rate (mg/min)</th>
      </tr>
      <tr class="row-pheno2">
        <td>Phenobarbital</td>
        <td><span id="phenoIV2" class="calc"></span> <span class="note-tip" data-note="20 mg/kg (max 800 mg)">ⓘ</span></td>
        <td><span id="phenoRate2" class="calc"></span> <span class="note-tip" data-note="1 mg/kg/min">ⓘ</span></td>
      </tr>
      <tr class="row-pheny">
        <td>Phenytoin</td>
        <td><span id="phenyIV" class="calc"></span> <span class="note-tip" data-note="20 mg/kg (max 1000 mg)">ⓘ</span></td>
        <td><span id="phenyRate" class="calc"></span> <span class="note-tip" data-note="1 mg/kg/min">ⓘ</span></td>
      </tr>
      <tr class="row-valp2">
        <td>Sodium Valproate</td>
        <td><span id="valpIV2" class="calc"></span> <span class="note-tip" data-note="40–60 mg/kg">ⓘ</span></td>
        <td><span id="valpRate2" class="calc"></span> <span class="note-tip" data-note="5–8 mg/kg/min">ⓘ</span></td>
      </tr>
      <tr class="row-lev2">
        <td>Levetiracetam</td>
        <td><span id="levIV2" class="calc"></span> <span class="note-tip" data-note="60 mg/kg">ⓘ</span></td>
        <td><span id="levRate2" class="calc"></span> <span class="note-tip" data-note="Max rate">ⓘ</span></td>
      </tr>
    </tbody>
  </table>

  <!-- Group 3: Infusions / Sedation -->
  <table id="seInfusions" style="margin-top:12px;border-collapse:separate;border-spacing:0;">
    <thead>
      <tr>
        <th>4th Line</th>
        <th>IV Loading (mg/kg)</th>
        <th>Maintenance (mg/kg/hr)</th>
        <th>Max Dose</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Propofol</td>
        <td><span id="propLoad" class="calc"></span> <span class="note-tip" data-note="0.5–2 mg/kg">ⓘ</span></td>
        <td><span id="propMaint" class="calc"></span> <span class="note-tip" data-note="1.5–4 mg/kg/hr">ⓘ</span></td>
        <td><span id="propMax" class="calc"></span> <span class="note-tip" data-note="5 mg/kg">ⓘ</span></td>
      </tr>
      <tr>
        <td>Midazolam Drip</td>
        <td><span id="midDripLoad" class="calc"></span> <span class="note-tip" data-note="0.1–0.2 mg/kg">ⓘ</span></td>
        <td><span id="midDripMaint" class="calc"></span> <span class="note-tip" data-note="0.05–0.4 mg/kg/hr">ⓘ</span></td>
        <td><span id="midDripMax" class="calc"></span> <span class="note-tip" data-note="10 mg">ⓘ</span></td>
      </tr>
      <tr class="row-ketamine">
        <td>Ketamine</td>
        <td><span id="ketaLoad" class="calc"></span> <span class="note-tip" data-note="2–3 mg/kg">ⓘ</span></td>
        <td><span id="ketaMaint" class="calc"></span> <span class="note-tip" data-note="0.01–0.06 mg/kg/hr">ⓘ</span></td>
        <td><span id="ketaMax" class="calc"></span></td>
      </tr>
    </tbody>
  </table>
</details>

<details>
  <summary>Anaphylaxis</summary>
  <table id="anaEpiTable">
    <thead>
      <tr>
        <th>Medication</th>
        <th>IM</th>
        <th>IV Infusion</th>
        <th>IV Fluids</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Epinephrine</td>
        <td id="anaEpiIM"><span class="calc"></span> <span class="note-tip" data-note="0.01 milligram/kg (0.01 mL/kg of 1:1000 dilution)">ⓘ</span></td>
        <td id="anaEpiInf"><span class="calc"></span> <span class="note-tip" data-note="0.1–0.3 microgram/kg per min; titrate as needed; max 1.5 micrograms/kg per min">ⓘ</span></td>
        <td id="anaEpiFluids"><span class="calc"></span></td>
      </tr>
    </tbody>
  </table>

  <table id="anaAdjTable" style="margin-top:12px;">
    <thead>
      <tr>
        <th>Diphenhydramine</th>
        <th>Ranitidine</th>
        <th>Hydrocortisone</th>
        <th>Methylprednisolone</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td id="anaDip"><span class="calc"></span> <span class="note-tip" data-note="1 mg/kg q6h">ⓘ</span></td>
        <td id="anaRani"><span class="calc"></span> <span class="note-tip" data-note="0.5 mg/kg over 5 minutes">ⓘ</span></td>
        <td id="anaHydro"><span class="calc"></span> <span class="note-tip" data-note="5–10 mg/kg IV (maximum 500 mg)">ⓘ</span></td>
        <td id="anaMethyl"><span class="calc"></span> <span class="note-tip" data-note="1–2 mg/kg IV (maximum 125 mg)">ⓘ</span></td>
      </tr>
    </tbody>
  </table>
</details>

<!-- Diagnostics: quick self-checks -->
<details id="diag">
  <summary>Diagnostics (tap to run checks)</summary>
  <button id="runChecks" type="button">Run Self‑Check</button>
  <pre id="checkOut"></pre>
</details>

<script defer>
// Utility: open/close sections based on weight
function setSectionsOpen(open){
  document.querySelectorAll('details:not(#diag)').forEach(d=>{
    if(open){ d.setAttribute('open',''); } else { d.removeAttribute('open'); }
  });
}

function mark(el, text){ if(!el) return; el.textContent = text; el.classList.add('computed'); }

function clearAll(){
  // Clear only dynamic computed cells
  document.querySelectorAll('td.computed').forEach(td=>{td.textContent='';td.classList.remove('computed');});
  // Clear main IDs
  [
    'maintOut','mildOut','modOut','sevOut','bolusOut',
    'ettSize','ettDepth','bladeSize','epiIV','epiET','atroIV','atroET','adeno1','adeno2','amioPulse','amioArrest','cv1','cv2','defib1','defib2',
    'midIV','midINIM','diazIV','diazPR',
    'phenoIV2','phenoRate2', 'phenyIV','phenyRate', 'valpIV2','valpRate2', 'levIV2','levRate2',
    'propLoad','propMaint','propMax','midDripLoad','midDripMaint','midDripMax','ketaLoad','ketaMaint','ketaMax'
  ].forEach(id=>{ const el=document.getElementById(id); if(el){el.textContent='';el.classList.remove('computed');} });

  // Clear quick meds cells
  ['para100','para125','para250','ibu200','amox100q8','amox100q12','amox125q8','amox125q12','amox250q8','amox250q12','azith200q24','cefix100q12','cefix100q24','cefix20_5q12','cefix20_5q24','ampSulbIVq6']
    .forEach(id=>{ const el=document.getElementById(id); if(!el) return; el.textContent=''; el.classList.remove('computed'); });

  // Clear anaphylaxis computed spans only (keep icons)
  document.querySelectorAll('#anaEpiIM .calc,#anaEpiInf .calc,#anaEpiFluids .calc,#anaDip .calc,#anaRani .calc,#anaHydro .calc,#anaMethyl .calc')
    .forEach(s=>{s.textContent='';s.classList.remove('computed');});
}

function calculate(){
  const w = parseFloat(document.getElementById('weightInput').value);
  const warn = document.getElementById('warning');
  if(!w||w<=0){ warn.textContent=''; clearAll(); setSectionsOpen(false); return; }
  warn.textContent = (w<5||w>120)?'⚠ Check dosing range':' ';
  setSectionsOpen(true);

  /* ===== IV Fluids ===== */
  let t= w<=10?100*w : w<=20?1000+50*(w-10) : 1500+20*(w-20);
  mark(document.getElementById('maintOut'), `${t.toFixed(0)} mL/24h (${(t/24).toFixed(1)} mL/hr)`);
  mark(document.getElementById('mildOut'), `${((w*50)/8).toFixed(1)} mL/hr × 8h`);
  mark(document.getElementById('modOut'), `${((w*100)/6).toFixed(1)} mL/hr × 6h`);
  mark(document.getElementById('sevOut'), `${((w*100)/6).toFixed(1)} mL/hr × 6h then ${((w*50)/6).toFixed(1)} mL/hr × 6h`);
  mark(document.getElementById('bolusOut'), `${(w*20).toFixed(0)} mL`);

  // Quick meds (mL) under IV Fluids
  const pLo = 10*w, pHi = 20*w; // Paracetamol 10–20 mg/kg/dose
  mark(document.getElementById('para100'), (pLo/100).toFixed(2)+'–'+(pHi/100).toFixed(2)+' mL');
  mark(document.getElementById('para125'), (pLo/25).toFixed(2)+'–'+(pHi/25).toFixed(2)+' mL');
  mark(document.getElementById('para250'), (pLo/250).toFixed(2)+'–'+(pHi/250).toFixed(2)+' mL');
  mark(document.getElementById('ibu200'), ((10*w)/40).toFixed(2)+' mL'); // 200 mg/5 mL = 40 mg/mL

  // Amoxicillin quick table compute
  (function(){
    const wv=w||0;
    const fill=(id,val)=>{ const el=document.getElementById(id); if(!el) return; if(!wv){ el.textContent=''; el.classList.remove('computed'); return; } el.textContent=val; el.classList.add('computed'); };
    const c100=100; const c125=125/5; const c250=250/5;
    const q8_100 = (((25*wv)/3)/c100).toFixed(2)+'–'+(((50*wv)/3)/c100).toFixed(2)+' mL';
    const q12_100= (((25*wv)/2)/c100).toFixed(2)+'–'+(((50*wv)/2)/c100).toFixed(2)+' mL';
    const q8_125 = (((25*wv)/3)/c125).toFixed(2)+'–'+(((50*wv)/3)/c125).toFixed(2)+' mL';
    const q12_125= (((25*wv)/2)/c125).toFixed(2)+'–'+(((50*wv)/2)/c125).toFixed(2)+' mL';
    const q8_250 = (((25*wv)/3)/c250).toFixed(2)+'–'+(((50*wv)/3)/c250).toFixed(2)+' mL';
    const q12_250= (((25*wv)/2)/c250).toFixed(2)+'–'+(((50*wv)/2)/c250).toFixed(2)+' mL';
    fill('amox100q8', q8_100);  fill('amox100q12', q12_100);
    fill('amox125q8', q8_125);  fill('amox125q12', q12_125);
    fill('amox250q8', q8_250);  fill('amox250q12', q12_250);
  })();

  // Ampicillin–Sulbactam quick (mg per q6h dose)
  (function(){
    const dose=(200*w)/4; // 200 mg/kg/day q6h => /4
    const el=document.getElementById('ampSulbIVq6'); if(!el) return;
    el.textContent = dose.toFixed(0)+' mg'; el.classList.add('computed');
  })();

  // Azithro quick (mL per q24h)
  (function(){
    const el=document.getElementById('azith200q24'); if(!el) return;
    const conc=200/5; const vol=(10*w)/conc; el.textContent=vol.toFixed(2)+' mL'; el.classList.add('computed');
  })();

  // Cefixime quick (mL per dose q12/q24)
  (function(){
    const dose=8*w; const c100_5=100/5; const c20_5=20/5; // 20mg/5mL => 4 mg/mL
    const fill=(id,val)=>{const el=document.getElementById(id);if(el){el.textContent=val;el.classList.add('computed');}};
    fill('cefix100q12',(dose/c100_5).toFixed(2)+' mL');
    fill('cefix100q24',(dose/c100_5).toFixed(2)+' mL');
    fill('cefix20_5q12',(dose/c20_5).toFixed(2)+' mL');
    fill('cefix20_5q24',(dose/c20_5).toFixed(2)+' mL');
  })();

  // ===== New quick antibiotic tables =====
  (function(){
    const wv = w||0; const fill=(id,val)=>{const el=document.getElementById(id); if(!el) return; if(!wv){el.textContent=''; el.classList.remove('computed'); return;} el.textContent=val; el.classList.add('computed'); };

    // Ceftriaxone: mg per dose
    if(document.getElementById('ceftriaIVq12')){
      const mgMin=75*wv, mgMax=100*wv; fill('ceftriaIVq12', (mgMin/2).toFixed(0)+'–'+(mgMax/2).toFixed(0)+' mg'); fill('ceftriaIVq24', mgMin.toFixed(0)+'–'+mgMax.toFixed(0)+' mg');
    }

    // Cefuroxime: PO mL (q12), IV mg (q8)
    const c125=125/5, c250=250/5; if(document.getElementById('cefur125q12')){ fill('cefur125q12', (((20*wv)/2)/c125).toFixed(2)+'–'+(((30*wv)/2)/c125).toFixed(2)+' mL'); }
    if(document.getElementById('cefur250q12')){ fill('cefur250q12', (((20*wv)/2)/c250).toFixed(2)+'–'+(((30*wv)/2)/c250).toFixed(2)+' mL'); }
    if(document.getElementById('cefurIVq8')){ fill('cefurIVq8', ((100*wv)/3).toFixed(0)+'–'+((150*wv)/3).toFixed(0)+' mg'); }

    // Cephalexin: mL q12
    const c100=100, c125b=125/5, c250b=250/5; if(document.getElementById('cephal100q12')){ fill('cephal100q12', (((25*wv)/2)/c100).toFixed(2)+'–'+(((50*wv)/2)/c100).toFixed(2)+' mL'); }
    if(document.getElementById('cephal125q12')){ fill('cephal125q12', (((25*wv)/2)/c125b).toFixed(2)+'–'+(((50*wv)/2)/c125b).toFixed(2)+' mL'); }
    if(document.getElementById('cephal250q12')){ fill('cephal250q12', (((25*wv)/2)/c250b).toFixed(2)+'–'+(((50*wv)/2)/c250b).toFixed(2)+' mL'); }

    // Clarithromycin: mL q12
    const clar=125/5; if(document.getElementById('clarith125q12')){ fill('clarith125q12', (((15*wv)/2)/clar).toFixed(2)+' mL'); }

    // Clindamycin: mL q8
    const clinda=75/5; if(document.getElementById('clinda75q8')){ fill('clinda75q8', (((20*wv)/3)/clinda).toFixed(2)+'–'+(((30*wv)/3)/clinda).toFixed(2)+' mL'); }

    // Co-amoxiclav: mL q8 & q12
    const c156=156.25/5, c228=228.5/5, c312=312.5/5, c457=457/5; // mg/mL
    function coFill(prefix, conc){ const q8=(((25*wv)/3)/conc).toFixed(2)+'–'+(((45*wv)/3)/conc).toFixed(2)+' mL'; const q12=(((25*wv)/2)/conc).toFixed(2)+'–'+(((45*wv)/2)/conc).toFixed(2)+' mL'; fill(prefix+'q8', q8); fill(prefix+'q12', q12); }
    if(document.getElementById('coamox156q8')){ coFill('coamox156', c156); }
    if(document.getElementById('coamox228q8')){ coFill('coamox228', c228); }
    if(document.getElementById('coamox312q8')){ coFill('coamox312', c312); }
    if(document.getElementById('coamox457q8')){ coFill('coamox457', c457); }

    // Metronidazole: mL q6
    const metro=125/5; if(document.getElementById('metro125q6')){ fill('metro125q6', (((15*wv)/4)/metro).toFixed(2)+'–'+(((30*wv)/4)/metro).toFixed(2)+' mL'); }
  })();

  /* ===== Resuscitation computed values ===== */

  const r = document.querySelectorAll('#resusTable tbody tr');
  r.forEach(tr=>tr.classList.remove('resusA','resusB','resusStart','resusEnd'));
  let flip=false; const markGroup=(s,e)=>{ flip=!flip; for(let i=s;i<=e;i++){ r[i].classList.add(flip?'resusA':'resusB'); } r[s].classList.add('resusStart'); r[e].classList.add('resusEnd'); };
  markGroup(0,2); markGroup(3,4); markGroup(5,10); markGroup(11,14);

  let ett=w<3?3:w<=5?3.5:w<=10?4:w<=15?4.5:w<=20?5:(w/10+3.5); ett=Math.round(ett*2)/2;
  mark(document.getElementById('ettSize'),ett.toFixed(1)+' mm');
  mark(document.getElementById('ettDepth'),(ett*3).toFixed(1)+' cm');
  mark(document.getElementById('bladeSize'), w<3?'Miller 0': w<5?'Miller 1': w<10?'Miller 1/Mac2': w<20?'Mac2':'Mac3');
  mark(document.getElementById('epiIV'), (0.01*w).toFixed(3)+' mg = '+(0.01*w*10).toFixed(2)+' mL (1:10,000)');
  mark(document.getElementById('epiET'), (0.1*w).toFixed(2)+' mg = '+(0.1*w).toFixed(2)+' mL (1:1,000)');
  mark(document.getElementById('atroIV'),Math.max(0.1,0.02*w).toFixed(2)+' mg');
  mark(document.getElementById('atroET'),(0.04*w).toFixed(2)+'–'+(0.06*w).toFixed(2)+' mg');
  mark(document.getElementById('adeno1'),Math.min(0.1*w,6).toFixed(2)+' mg');
  mark(document.getElementById('adeno2'),Math.min(0.2*w,12).toFixed(2)+' mg');
  let amPulse=5*w; let amPulseVol=(amPulse/50);
  mark(document.getElementById('amioPulse'), amPulse.toFixed(1)+' mg = '+amPulseVol.toFixed(2)+' mL (150 mg/3 mL ampoule)');
  let amArrest=5*w; let amArrestVol=(amArrest/50);
  mark(document.getElementById('amioArrest'), amArrest.toFixed(1)+' mg = '+amArrestVol.toFixed(2)+' mL (150 mg/3 mL ampoule)');
  mark(document.getElementById('cv1'),(w*1).toFixed(0)+' J'); mark(document.getElementById('cv2'),(w*2).toFixed(0)+' J');
  mark(document.getElementById('defib1'),(w*2).toFixed(0)+' J'); mark(document.getElementById('defib2'),(w*4).toFixed(0)+' J');

  /* ===== Status Epilepticus ===== */
  // Initial treatment
  mark(document.getElementById('midIV'), (0.10*w).toFixed(2)+'–'+(0.20*w).toFixed(2)+' mg');
  mark(document.getElementById('midINIM'), (0.20*w).toFixed(2)+' mg');
  mark(document.getElementById('diazIV'), (0.10*w).toFixed(2)+'–'+(0.30*w).toFixed(2)+' mg');
  mark(document.getElementById('diazPR'), (0.50*w).toFixed(2)+' mg');

  // 2nd/3rd line
  mark(document.getElementById('phenoIV2'), (20*w).toFixed(1)+' mg');
  mark(document.getElementById('phenoRate2'), (1*w).toFixed(1)+' mg/min');
  mark(document.getElementById('phenyIV'), (20*w).toFixed(1)+' mg');
  mark(document.getElementById('phenyRate'), (1*w).toFixed(1)+' mg/min');
  mark(document.getElementById('valpIV2'), (40*w).toFixed(1)+'–'+(60*w).toFixed(1)+' mg');
  mark(document.getElementById('valpRate2'), (5*w).toFixed(1)+'–'+(8*w).toFixed(1)+' mg/min');
  mark(document.getElementById('levIV2'), (60*w).toFixed(1)+' mg');
  mark(document.getElementById('levRate2'), '100 mg/min');

  // Infusions
  mark(document.getElementById('propLoad'), (0.5*w).toFixed(2)+'–'+(2.0*w).toFixed(2)+' mg');
  mark(document.getElementById('propMaint'), (1.5*w).toFixed(2)+'–'+(4.0*w).toFixed(2)+' mg/hr');
  mark(document.getElementById('propMax'), (5*w).toFixed(2)+' mg');
  mark(document.getElementById('midDripLoad'), (0.10*w).toFixed(2)+'–'+(0.20*w).toFixed(2)+' mg');
  mark(document.getElementById('midDripMaint'), (0.05*w).toFixed(2)+'–'+(0.40*w).toFixed(2)+' mg/hr');
  mark(document.getElementById('midDripMax'), '10 mg');
  mark(document.getElementById('ketaLoad'), (2.0*w).toFixed(2)+'–'+(3.0*w).toFixed(2)+' mg');
  mark(document.getElementById('ketaMaint'), (0.01*w).toFixed(3)+'–'+(0.06*w).toFixed(3)+' mg/hr');

  /* ===== Anaphylaxis ===== */
  const epiIMmg=(0.01*w), epiIMmL=epiIMmg; // 1 mg/mL
  mark(document.querySelector('#anaEpiIM .calc'), epiIMmg.toFixed(3)+' mg = '+epiIMmL.toFixed(3)+' mL (1:1,000)');
  const epiInfMin=(0.1*w), epiInfMax=(0.3*w), epiInfCeil=(1.5*w);
  mark(document.querySelector('#anaEpiInf .calc'), epiInfMin.toFixed(2)+'–'+epiInfMax.toFixed(2)+' µg/min (max '+epiInfCeil.toFixed(1)+' µg/min)');
  mark(document.querySelector('#anaEpiFluids .calc'), (10*w).toFixed(0)+'–'+(20*w).toFixed(0)+' mL');
  mark(document.querySelector('#anaDip .calc'), (1*w).toFixed(1)+' mg');
  const hydLo=Math.min(500,5*w), hydHi=Math.min(500,10*w);
  mark(document.querySelector('#anaHydro .calc'), hydLo.toFixed(0)+'–'+hydHi.toFixed(0)+' mg');
  const metLo=Math.min(125,1*w), metHi=Math.min(125,2*w);
  mark(document.querySelector('#anaMethyl .calc'), metLo.toFixed(0)+'–'+metHi.toFixed(0)+' mg');
  mark(document.querySelector('#anaRani .calc'), (0.5*w).toFixed(1)+' mg');
}

// Label helpers for stacked/mobile modes (kept minimal)
function setDataLabelsFromThead(table){
  if(!table) return; const thead=table.querySelector('thead'); if(!thead) return;
  const labels=[...thead.querySelectorAll('th')].map(th=>th.textContent.trim());
  table.querySelectorAll('tbody tr').forEach(tr=>{ [...tr.cells].forEach((td,i)=>{ td.setAttribute('data-label', labels[i]||''); }); });
}
function setDataLabelsSE(){
  const tbl=document.getElementById('seTable'); if(!tbl) return;
  const g1=['Medication','IV','IN/IM or PR'];
  ['row-midazolam','row-diazepam'].forEach(cls=>{ tbl.querySelectorAll('tr.'+cls+' td').forEach((td,i)=>{ td.setAttribute('data-label', g1[Math.min(i,2)]||''); }); });
  const g2=['Medication','IV','Rate (mg/min)'];
  ['row-pheno2','row-pheny','row-valp2','row-lev2'].forEach(cls=>{ tbl.querySelectorAll('tr.'+cls+' td').forEach((td,i)=>{ td.setAttribute('data-label', g2[Math.min(i,2)]||''); }); });
}
function setAllDataLabels(){
  ['resultTable','resusTable','seTable','seInfusions','anaEpiTable','anaAdjTable','amoxQuick','ampSulbQuick','azithQuick','cefixQuick']
    .forEach(id=>setDataLabelsFromThead(document.getElementById(id)));
  setDataLabelsSE();
}

function computeAndLabel(){ calculate(); setAllDataLabels(); }

document.getElementById('weightInput').addEventListener('input', computeAndLabel);
computeAndLabel();
</script>

<script>
// Tooltips: click to toggle (delegated)
(function(){
  document.addEventListener('click',function(e){
    const tip = e.target.closest('.note-tip');
    if(tip){
      e.stopPropagation();
      document.querySelectorAll('.note-tip.touch-active').forEach(t=>{ if(t!==tip) t.classList.remove('touch-active'); });
      tip.classList.toggle('touch-active');
    } else {
      document.querySelectorAll('.note-tip.touch-active').forEach(t=>t.classList.remove('touch-active'));
    }
  });
})();

// Diagnostics
(function(){
  const btn=document.getElementById('runChecks');
  const out=document.getElementById('checkOut');
 